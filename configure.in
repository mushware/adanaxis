dnl Process this file with autoconf to produce a configure script.
AC_INIT()
AC_CANONICAL_SYSTEM

AM_INIT_AUTOMAKE(coreapp, 0.0)
MY_SUBDIRS="src"
AC_SUBST(MY_SUBDIRS)
AC_PREFIX_DEFAULT(.)
AM_CONFIG_HEADER(config.h)

dnl Checks for programs.
AC_PROG_MAKE_SET
AC_PROG_CXX
AC_PROG_INSTALL
AC_PATH_PROG(ac_prog_find, find)

dnl Checks for libraries.
AC_CHECK_HEADER(windows.h)
if test "x$ac_cv_header_windows_h" = "xyes" ; then
AC_CHECK_LIB(opengl32, main)
AC_CHECK_LIB(glu32, main)
AC_CHECK_LIB(glut32, main)
else
AC_CHECK_LIB(gl, main,, AC_CHECK_LIB(GL, main))
AC_CHECK_LIB(glu, main,, AC_CHECK_LIB(GLU, main))
AC_CHECK_LIB(glut, main,, AC_CHECK_LIB(GLUT, main))
fi
AC_CHECK_LIB(PCRE, main)
AC_CHECK_LIB(expat, main)
AC_CHECK_LIB(ungif, main)
AC_CHECK_LIB(tiff, main)

dnl Checks for header files.
AC_CHECK_HEADERS(sstream)
AC_CHECK_HEADERS(unistd.h)

AC_CHECK_HEADERS(OpenGL/gl.h)
AC_CHECK_HEADERS(OpenGL/glu.h)

AC_CHECK_HEADERS(GLUT/glut.h)
AC_CHECK_HEADERS(GL/gl.h)
AC_CHECK_HEADERS(GL/glut.h)

dnl Checks for typedefs, structures, and compiler characteristics.
AC_C_BIGENDIAN

dnl Checks for library functions.

dnl Die if we can't build
case "$target" in
powerpc-apple-darwin*)
echo
echo Target powerpc-apple-darwin : Please use Project Builder to build for MacOS X, ;
echo OpenGL libraries inaccessible.  Abandoned
exit ;;
esac
dnl Automatically generate src/makefile.am if it's not there
AC_CHECK_FILE(src/Makefile.am,,
echo Building src/Makefile.am
cd src
echo 'bin_PROGRAMS=coreapp' > Makefile.am
echo -n 'coreapp_SOURCES=' >> Makefile.am
$ac_prog_find . -name '*.cpp' -printf " %p" >> Makefile.am
$ac_prog_find . -name '*.h' -printf " %p" >> Makefile.am
echo >> Makefile.am
echo INCLUDES=-IAPI >> Makefile.am
cd ..
)
AC_OUTPUT(Makefile src/Makefile)
